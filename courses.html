<!DOCTYPE html>  <html lang="ar" dir="rtl">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1.0" />  
<title>📚 إدارة الكورسات - منصة YLEARN</title>  
<style>  
  body {  
    margin: 0;  
    font-family: "Cairo", sans-serif;  
    background: #0b0f19;  
    color: #fff;  
    min-height: 100vh;  
  }  header {
background: #111827;
padding: 1rem 2rem;
display: flex;
justify-content: space-between;
align-items: center;
box-shadow: 0 0 10px rgba(0,0,0,0.4);
}

header h1 {
color: #00b2ff;
margin: 0;
font-size: 1.3rem;
}

button {
border: none;
border-radius: 8px;
cursor: pointer;
transition: 0.3s;
}

button.logout {
background: #e63946;
color: #fff;
padding: 0.6rem 1.2rem;
}

button:hover {
opacity: 0.9;
}

.content {
padding: 1rem;
max-width: 900px;
margin: auto;
}

h2 {
color: #00b2ff;
margin-top: 1.5rem;
}

input, textarea, select {
width: 100%;
padding: 0.8rem;
margin: 0.5rem 0;
border: none;
border-radius: 8px;
background: #1e2636;
color: #fff;
font-size: 1rem;
}

textarea {
resize: vertical;
min-height: 70px;
}

.course-card {
background: #1e2636;
padding: 1rem;
border-radius: 10px;
margin: 1rem 0;
box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

.course-card h3 {
margin-top: 0;
color: #00b2ff;
}

.course-card p {
margin: 6px 0;
color: #ccc;
}

.delete-btn {
background: #e63946;
color: #fff;
padding: 0.6rem 1rem;
border-radius: 8px;
font-size: 0.9rem;
}

.create-btn {
background: #00b2ff;
color: #fff;
padding: 0.8rem;
width: 100%;
font-size: 1rem;
border-radius: 8px;
margin-top: 0.5rem;
}

@media (max-width: 600px) {
header h1 { font-size: 1.1rem; }
.content { padding: 0.8rem; }
}
</style>

</head>  
<body>  
  <header>  
    <h1>🎓 إدارة الكورسات - YLEARN</h1>  
    <button class="logout">رجوع للوحة الأدمن</button>  
  </header>    <div class="content">  
    <h2>👨‍🏫 اختر المدرس</h2>  
    <select id="teacherSelect"><option value="">-- اختر مدرس --</option></select>  <h2>➕ إنشاء كورس جديد</h2>  
<input type="text" id="courseName" placeholder="اسم الكورس">  
<textarea id="courseDesc" placeholder="وصف الكورس"></textarea>  
<input type="number" id="coursePrice" placeholder="سعر الكورس بالجنيه">  
<button id="createCourseBtn" class="create-btn">إنشاء الكورس</button>  

<h2>📦 كورسات المدرس المحدد</h2>  
<div id="coursesContainer"></div>

  </div>    <script type="module">  
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";  
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";  
    import { getDatabase, ref, push, set, get, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";  
  
    // إعدادات Firebase  
    const firebaseConfig = {  
      apiKey: "AIzaSyDW80ZbwOB7QHHW76kSL9cqlzMoyPFZ7nI",  
      authDomain: "ylearn-fe1fa.firebaseapp.com",  
      databaseURL: "https://ylearn-fe1fa-default-rtdb.firebaseio.com",  
      projectId: "ylearn-fe1fa",  
      storageBucket: "ylearn-fe1fa.firebasestorage.app",  
      messagingSenderId: "1092852055944",  
      appId: "1:1092852055944:web:85c3df7cf4c0cbcdca043d"  
    };  
  
    const app = initializeApp(firebaseConfig);  
    const auth = getAuth(app);  
    const db = getDatabase(app);  
  
    const teacherSelect = document.getElementById("teacherSelect");  
    const coursesContainer = document.getElementById("coursesContainer");  
  
    let selectedTeacherId = null;  
  
    // تحميل قائمة المدرسين  
    async function loadTeachers() {  
      const snap = await get(ref(db, "teachers"));  
      teacherSelect.innerHTML = '<option value="">-- اختر مدرس --</option>';  
      if (snap.exists()) {  
        Object.entries(snap.val()).forEach(([id, t]) => {  
          const opt = document.createElement("option");  
          opt.value = id;  
          opt.textContent = `${t.name}${t.grade ? ` (${t.grade})` : ""}`;  
          teacherSelect.appendChild(opt);  
        });  
      } else {  
        const opt = document.createElement("option");  
        opt.textContent = "❌ لا يوجد مدرسين بعد";  
        teacherSelect.appendChild(opt);  
      }  
    }  
  
    // عند اختيار المدرس  
    teacherSelect.addEventListener("change", () => {  
      selectedTeacherId = teacherSelect.value;  
      loadCourses();  
    });  
  
    // تحميل كورسات المدرس المختار  
    async function loadCourses() {  
      coursesContainer.innerHTML = "";  
      if (!selectedTeacherId) return;  
      const snap = await get(ref(db, `teachers/${selectedTeacherId}/courses`));  
      if (!snap.exists()) {  
        coursesContainer.innerHTML = "<p>❌ لا توجد كورسات حالياً.</p>";  
        return;  
      }  
      for (const courseId of Object.keys(snap.val())) {  
        const cSnap = await get(ref(db, `courses/${courseId}`));  
        if (!cSnap.exists()) continue;  
        const c = cSnap.val();  
        const div = document.createElement("div");  
        div.className = "course-card";  
        div.innerHTML = `  
          <h3>${c.name}</h3>  
          <p>${c.description}</p>  
          <p>💰 السعر: ${c.price} جنيه</p>  
          <button class="delete-btn" data-id="${courseId}">🗑️ حذف الكورس</button>  
        `;  
        div.querySelector(".delete-btn").addEventListener("click", () => deleteCourse(courseId));  
        coursesContainer.appendChild(div);  
      }  
    }  
  
    // حذف كورس  
    async function deleteCourse(courseId) {  
      if (!confirm("هل أنت متأكد من حذف هذا الكورس؟")) return;  
      await remove(ref(db, `courses/${courseId}`));  
      await remove(ref(db, `teachers/${selectedTeacherId}/courses/${courseId}`));  
      alert("🗑️ تم حذف الكورس بنجاح!");  
      loadCourses();  
    }  
  
    // إنشاء كورس جديد  
    document.getElementById("createCourseBtn").addEventListener("click", async () => {  
      if (!selectedTeacherId) return alert("اختر المدرس أولاً");  
      const name = document.getElementById("courseName").value.trim();  
      const desc = document.getElementById("courseDesc").value.trim();  
      const price = document.getElementById("coursePrice").value.trim();  
      if (!name || !desc || !price) return alert("أكمل جميع الحقول");  
  
      const courseRef = push(ref(db, "courses"));  
      await set(courseRef, {  
        name,  
        description: desc,  
        price,  
        teacherId: selectedTeacherId,  
        createdAt: Date.now()  
      });  
  
      // ربط الكورس بالمدرس  
      await set(ref(db, `teachers/${selectedTeacherId}/courses/${courseRef.key}`), true);  
  
      alert("✅ تم إنشاء الكورس بنجاح!");  
      document.getElementById("courseName").value = "";  
      document.getElementById("courseDesc").value = "";  
      document.getElementById("coursePrice").value = "";  
      loadCourses();  
    });  
  
    // التحقق من تسجيل الدخول  
    onAuthStateChanged(auth, (user) => {  
      if (!user) return (window.location.href = "login.html");  
      loadTeachers();  
    });  
  
    // زر الرجوع إلى صفحة الأدمن  
    document.querySelector(".logout").addEventListener("click", () => {  
      window.location.href = "admin.html";  
    });  
  </script>  </body>  
</html>