<!doctype html>

<html lang="ar" dir="rtl">          
<head>          
  <meta charset="utf-8" />          
  <meta name="viewport" content="width=device-width,initial-scale=1" />          
  <title>ğŸ“ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ - THE GIANT</title>          
  <style>          
    :root {          
      --bg:#0b0f19; --card:#111827; --accent:#00b2ff;          
      --muted:#cbd5e1; --ok:#00b258; --danger:#e63946;          
    }          
    body {          
      margin:0; font-family:"Cairo",sans-serif;          
      background:var(--bg); color:#fff; padding:16px;          
    }          
    header {          
      display:flex; justify-content:space-between; align-items:center;          
      background:var(--card); padding:12px; border-radius:10px;          
      flex-wrap:wrap; gap:8px;          
    }          
    header h1 { margin:0; color:var(--accent); font-size:1.2rem; }          
    .main { max-width:1000px; margin:18px auto; }          
    .banner {          
      background:linear-gradient(45deg,#00b2ff,#16a34a);          
      padding:12px; border-radius:10px; font-weight:700; font-size:1rem;          
    }          
    .select-box {          
      background:#1e2636; padding:12px; border-radius:10px; margin-top:12px;          
    }          
    select {          
      width:100%; padding:10px; border-radius:8px; border:0;          
      background:#0b0f19; color:#fff; font-size:1rem;          
    }          
    .course-grid {          
      display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr));          
      gap:12px; margin-top:14px;          
    }          
    .course-card {          
      background:#1e2636; padding:12px; border-radius:10px; text-align:right;          
    }          
    .course-card h3 { color:var(--accent); margin:0; font-size:1.1rem; }          
    .course-card p { color:var(--muted); margin:8px 0; font-size:0.95rem; }          
    .btn {          
      border:0; padding:10px; border-radius:8px; width:100%;          
      cursor:pointer; font-weight:600; font-size:0.95rem;          
    }          
    .buy-btn { background:linear-gradient(45deg,#00b2ff,#06b6d4); color:#000; }          
    .view-btn { background:#16a34a; color:#fff; }          
    .modal {          
      position:fixed; inset:0; background:rgba(0,0,0,0.6);          
      display:none; align-items:center; justify-content:center;          
      padding:16px; z-index:50;          
    }          
    .modal .box {          
      background:var(--card); border-radius:12px; padding:16px;          
      width:100%; max-width:520px;          
    }          
    .field { margin:8px 0; }          
    label { display:block; margin-bottom:6px; color:var(--muted); font-size:0.9rem; }          
    input[type="text"], textarea {          
      width:100%; padding:10px; border-radius:8px; border:0;          
      background:#0b1220; color:#fff; font-size:1rem;          
    }          
    .small { font-size:0.9rem; color:var(--muted); }          
    .ok { color:var(--ok); }          
    .danger { color:var(--danger); }          
    .row { display:flex; flex-wrap:wrap; gap:8px; }          
    .row .btn { flex:1 1 48%; }          
    .hidden { display:none; }          
@media (max-width:600px) {          
  body { padding:8px; }          
  header h1 { font-size:1rem; }          
  .banner { font-size:0.9rem; }          
  .btn { font-size:0.9rem; padding:8px; }          
  .modal .box { max-width:95%; padding:12px; }          
  .row .btn { flex:1 1 100%; }          
}        
  </style>          
</head>          
<body>          
<header>          
  <h1>ğŸ“ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ - THE GIANT</h1>          
  <button id="logoutBtn" class="btn" style="background:linear-gradient(45deg,#ef4444,#b91c1c);color:#fff;">ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>          
</header>          
<div class="main">          
  <div class="banner" id="bannerText">Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ! Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³ ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ ğŸš€</div>          
  <div class="select-box">          
    <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³:</label>          
    <select id="teacherSelect"><option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³ --</option></select>          
  </div>          
  <div id="coursesContainer" class="course-grid"></div>          
</div>    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø´Ø±Ø§Ø¡ -->  <div id="buyModal" class="modal">          
  <div class="box">          
    <h3 id="modalCourseTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´Ø±Ø§Ø¡</h3>          
    <div class="note">          
      <p class="small">Ø§Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø´Ø±Ø§Ø¡ Ø§Ù„ÙƒÙˆØ±Ø³ Ø§Ø¶ØºØ· Ø¹Ù„ÙŠ Ø§Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡  Ø­ØªÙŠ ØªØ³ØªØ·ÙŠØ¹ Ù…Ù† Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙƒÙˆØ±Ø³ Ø§ÙƒÙ…Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ ÙˆØ£Ø±Ø³Ù„ ØµÙˆØ±Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ù„Ø±Ù‚Ù… 01289050156</p>          
    </div>          
    <div id="paymentInfoArea">          
      <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="modalPrice">0</span> Ø¬Ù†ÙŠÙ‡</p>          
      <div class="field">          
        <label>Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹</label>          
        <p class="muted">Ù…Ø­ÙØ¸Ø© Ø§ÙˆØ±Ù†Ø¬ ÙƒØ§Ø´:<strong>[01289050156]</strong></p>          
      </div>          
      <div class="field">          
        <label>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù‚ØµÙŠØ±Ø©</label>          
        <textarea id="paymentInstructions" rows="3">Ø­ÙˆÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø£Ø±Ø³Ù„ Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… (01289050156).Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒØ¯ Ø³ØªØ­ØµÙ„ Ø¹Ù„ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… </textarea>          
      </div>          
      <div class="field">          
        <label>Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡:</label>          
        <div class="row">          
          <button id="sendRequestBtn" class="btn buy-btn">ğŸ“© Ø£Ø±Ø³Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡</button>          
          <button id="openCodeInputBtn" class="btn" style="background:#374151;color:#fff;">ğŸ”‘ Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>          
        </div>          
        <p id="sendResult" class="small"></p>          
      </div>          
      <div id="codeArea" class="field hidden">          
        <label>Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„:</label>          
        <input type="text" id="activationCodeInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />          
        <div class="row" style="margin-top:8px;">          
          <button id="applyCodeBtn" class="btn view-btn">ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ âœ…</button>          
          <button id="closeModalBtn" class="btn" style="background:#374151;color:#fff;">Ø¥ØºÙ„Ø§Ù‚</button>          
        </div>          
        <p id="applyResult" class="small"></p>          
      </div>          
      <div class="field" style="margin-top:16px;text-align:center;">          
        <button id="backToCoursesBtn" class="btn" style="background:#4b5563;color:#fff;">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>          
      </div>          
    </div>          
  </div>          
</div>    <div id="toast" style="position:fixed;left:16px;bottom:16px;background:#111;padding:10px;border-radius:8px;display:none;"></div>    <script type="module">        
// Ù†ÙØ³ Ø§Ù„ÙØ§ÙŠØ±Ø¨ÙŠØ³ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙƒÙ…Ø§ Ù‡ÙŠ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„        
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";          
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";          
import { getDatabase, ref, get, set, update } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {    
  apiKey: "AIzaSyDW80ZbwOB7QHHW76kSL9cqlzMoyPFZ7nI",    
  authDomain: "ylearn-fe1fa.firebaseapp.com",    
  databaseURL: "https://ylearn-fe1fa-default-rtdb.firebaseio.com",    
  projectId: "ylearn-fe1fa",    
  storageBucket: "ylearn-fe1fa.appspot.com",    
  messagingSenderId: "1092852055944",    
  appId: "1:1092852055944:web:85c3df7cf4c0cbcdca043d"    
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

const teacherSelect = document.getElementById('teacherSelect');
const coursesContainer = document.getElementById('coursesContainer');
const banner = document.getElementById('bannerText');
const logoutBtn = document.getElementById('logoutBtn');
const buyModal = document.getElementById('buyModal');
const modalCourseTitle = document.getElementById('modalCourseTitle');
const modalPrice = document.getElementById('modalPrice');
const sendRequestBtn = document.getElementById('sendRequestBtn');
const sendResult = document.getElementById('sendResult');
const openCodeInputBtn = document.getElementById('openCodeInputBtn');
const codeArea = document.getElementById('codeArea');
const activationCodeInput = document.getElementById('activationCodeInput');
const applyCodeBtn = document.getElementById('applyCodeBtn');
const closeModalBtn = document.getElementById('closeModalBtn');
const applyResult = document.getElementById('applyResult');
const backToCoursesBtn = document.getElementById('backToCoursesBtn');
const toast = document.getElementById('toast');

let currentCourse = null;
let currentUid = null;
let studentGrade = null; // âœ… Ù„ØªØ®Ø²ÙŠÙ† ØµÙ Ø§Ù„Ø·Ø§Ù„Ø¨

logoutBtn.onclick = async () => {
  await signOut(auth);
  window.location.href = 'login.html';
};

onAuthStateChanged(auth, async (user) => {
  if (!user) return (window.location.href = 'login.html');
  currentUid = user.uid;

  const sSnap = await get(ref(db, `students/${currentUid}`));
  const sData = sSnap.exists() ? sSnap.val() : {};
  studentGrade = sData.grade || null; // âœ… Ø­ÙØ¸ Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨
  banner.textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${sData.name || 'Ø·Ø§Ù„Ø¨Ù†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²'}! Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³ ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ ğŸš€`;

  const teachersSnap = await get(ref(db, 'teachers'));
  teacherSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³ --</option>';
  if (teachersSnap.exists()) {
    Object.entries(teachersSnap.val()).forEach(([id, t]) => {
      // âœ… ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
      if (!studentGrade || t.grade === studentGrade) {
        const opt = document.createElement('option');
        opt.value = id;
        opt.textContent = t.name || 'Ù…Ø¯Ø±Ø³';
        teacherSelect.appendChild(opt);
      }
    });
  }

  const coursesSnap = await get(ref(db, 'courses'));
  const allCourses = coursesSnap.exists() ? coursesSnap.val() : {};

  teacherSelect.addEventListener('change', async () => {
    const teacherId = teacherSelect.value;
    coursesContainer.innerHTML = '';
    if (!teacherId) return;

    const teacherSnap = await get(ref(db, `teachers/${teacherId}`));
    if (teacherSnap.exists()) {
      const t = teacherSnap.val();
      const info = document.createElement('div');
      info.className = 'course-card';

      // âœ… Ù„Ùˆ ÙÙŠ ØµÙˆØ±Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø¹Ø±Ø¶Ù‡Ø§ ÙÙˆÙ‚ Ø§Ù„Ø§Ø³Ù…
      let imgHtml = '';
      // try common field names: photoUrl or photo
      if (t.photoUrl) {
        imgHtml = `<img src="${t.photoUrl}" alt="ØµÙˆØ±Ø© ${t.name}" style="width:100%;border-radius:10px;margin-bottom:10px;max-height:220px;object-fit:cover;">`;
      } else if (t.photo) {
        imgHtml = `<img src="${t.photo}" alt="ØµÙˆØ±Ø© ${t.name}" style="width:100%;border-radius:10px;margin-bottom:10px;max-height:220px;object-fit:cover;">`;
      }

      info.innerHTML = `
        ${imgHtml}
        <h3>ğŸ‘¨â€ğŸ« ${t.name || 'Ù…Ø¯Ø±Ø³'}</h3>
        <p>ğŸ“˜ Ø§Ù„Ù…Ø§Ø¯Ø©: ${t.subject || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'}</p>
        <p>ğŸ“ Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${t.grade || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'}</p>
        <p>ğŸ§• Ø§Ù„Ø³ÙƒØ±ØªÙŠØ±Ø©: ${t.secretary || 'ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©'}</p>
        <p>ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø³ÙƒØ±ØªÙŠØ±Ø©: ${t.secretaryPhone || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
      `;
      coursesContainer.appendChild(info);
    }

    const purchasedSnap = await get(ref(db, `students/${currentUid}/purchased`));
    const purchased = purchasedSnap.exists() ? purchasedSnap.val() : {};

    Object.entries(allCourses).forEach(([courseId, c]) => {
      if (c.teacherId !== teacherId) return;
      const card = document.createElement('div');
      card.className = 'course-card';
      const isPurchased = purchased && purchased[courseId] === true;

      const h3 = document.createElement('h3');
      h3.textContent = c.name || '';
      card.appendChild(h3);

      // âœ… ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ ØªØ­Øª Ø§Ø³Ù… Ø§Ù„ÙƒÙˆØ±Ø³ (Ù†Ø³ØªØ®Ø¯Ù… teacherSnap Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙˆÙ‚)
      try {
        if (teacherSnap && teacherSnap.exists()) {
          const teacherData = teacherSnap.val();
          const teacherPhoto = teacherData.photoUrl || teacherData.photo || null;
          if (teacherPhoto) {
            const img = document.createElement('img');
            img.src = teacherPhoto;
            img.alt = 'ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³';
            img.style.width = '100%';
            img.style.borderRadius = '10px';
            img.style.margin = '10px 0';
            img.style.maxHeight = '180px';
            img.style.objectFit = 'cover';
            card.appendChild(img);
          }
        }
      } catch (e) {
        // Ù„Ø§ ØªÙˆÙ‚Ù Ø§Ù„ØªÙ†ÙÙŠØ° Ù„Ùˆ Ø­ØµÙ„ Ø®Ø·Ø£ Ø¨Ø³ÙŠØ·
        console.warn('error showing teacher photo under course', e);
      }

      const pDesc = document.createElement('p');
      pDesc.textContent = c.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ';
      card.appendChild(pDesc);

      const pPrice = document.createElement('p');
      pPrice.textContent = 'ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ';
      const strong = document.createElement('strong');
      strong.textContent = c.price;
      pPrice.appendChild(strong);
      pPrice.appendChild(document.createTextNode(' Ø¬Ù†ÙŠÙ‡'));
      card.appendChild(pPrice);

      const btn = document.createElement('button');
      btn.id = `btn-${courseId}`;
      btn.className = 'btn ' + (isPurchased ? 'view-btn' : 'buy-btn');
      btn.textContent = isPurchased ? 'âœ… Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ±Ø³' : 'ğŸ›’ Ø§Ø´ØªØ±Ù Ø§Ù„ÙƒÙˆØ±Ø³';
      card.appendChild(btn);

      coursesContainer.appendChild(card);

      if (isPurchased) {
        btn.onclick = () => {
          window.location.href = `courseContent.html?courseId=${courseId}`;
        };
      } else {
        btn.onclick = () => openBuyModal({ courseId, courseName: c.name, price: c.price });
      }
    });
  });
});

function openBuyModal({ courseId, courseName, price }) {
  currentCourse = { courseId, courseName, price };
  modalCourseTitle.textContent = `Ø´Ø±Ø§Ø¡: ${courseName}`;
  modalPrice.textContent = price;
  sendResult.textContent = '';
  applyResult.textContent = '';
  activationCodeInput.value = '';
  codeArea.classList.add('hidden');
  buyModal.style.display = 'flex';
}

closeModalBtn.onclick = () => (buyModal.style.display = 'none');
backToCoursesBtn.onclick = () => (buyModal.style.display = 'none');

sendRequestBtn.onclick = async () => {
  if (!currentCourse) return;
  try {
    const sSnap = await get(ref(db, `students/${currentUid}`));
    const sData = sSnap.exists() ? sSnap.val() : {};
    const reqPath = `unlockRequests/${currentUid}_${currentCourse.courseId}`;
    const payload = {
      studentId: currentUid,
      studentName: sData.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
      courseName: currentCourse.courseName,
      courseId: currentCourse.courseId,
      price: currentCourse.price || 0,
      status: 'pending',
      timestamp: new Date().toISOString()
    };
    await set(ref(db, reqPath), payload);
    sendResult.textContent = 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø¹Ù†Ø¯ ØªÙˆÙ„ÙŠØ¯Ù‡.';
    sendResult.className = 'small ok';
  } catch (err) {
    console.error(err);
    sendResult.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨.';
    sendResult.className = 'small danger';
  }
};

openCodeInputBtn.onclick = () => codeArea.classList.remove('hidden');

applyCodeBtn.onclick = async () => {
  const code = activationCodeInput.value.trim();
  if (!code) {
    applyResult.textContent = 'Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£ÙˆÙ„Ø§Ù‹.';
    applyResult.className = 'small danger';
    return;
  }

  try {
    const codePath = `activationCodes/${currentUid}_${currentCourse.courseId}`;
    const codeSnap = await get(ref(db, codePath));

    if (!codeSnap.exists()) {
      applyResult.textContent = 'âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙƒÙˆØ¯ Ù…Ø®ØµØµ Ù„Ùƒ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ±Ø³.';
      applyResult.className = 'small danger';
      return;
    }

    const codeData = codeSnap.val();

    if (codeData.code !== code) {
      applyResult.textContent = 'âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­.';
      applyResult.className = 'small danger';
      return;
    }

    await set(ref(db, `students/${currentUid}/purchased/${currentCourse.courseId}`), true);
    await update(ref(db, codePath), {
      used: true,
      assignedTo: currentUid,
      usedAt: new Date().toISOString(),
      status: 'used'
    });

    applyResult.textContent = 'âœ… ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!';
    applyResult.className = 'small ok';
    setTimeout(() => (buyModal.style.display = 'none'), 1200);
  } catch (error) {
    console.error(error);
    applyResult.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙØ¹ÙŠÙ„.';
    applyResult.className = 'small danger';
  }
};

// âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ† Ø¨Ù†ÙØ³ ØµÙ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙ‚Ø· (Ù…Ù† users)
async function loadTeachersForSameGrade() {
  try {
    const studentRef = ref(db, `users/${currentUid}`);
    const studentSnap = await get(studentRef);
    if (!studentSnap.exists()) return;

    const studentGrade = studentSnap.val().grade; // â¬…ï¸ Ù…Ù† users Ù…Ø´ students
    const teachersRef = ref(db, 'teachers');
    const teachersSnap = await get(teachersRef);

    teacherSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³ --</option>';

    if (teachersSnap.exists()) {
      Object.entries(teachersSnap.val()).forEach(([teacherId, teacher]) => {
        // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
        if (teacher.grade && teacher.grade === studentGrade) {
          const option = document.createElement('option');
          option.value = teacherId;
          option.textContent = teacher.name || 'Ù…Ø¯Ø±Ø³';
          teacherSelect.appendChild(option);
        }
      });
    } else {
      console.warn('No teachers found.');
    }

  } catch (err) {
    console.error('Error loading teachers:', err);
  }
}

// âœ… Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
onAuthStateChanged(auth, async (user) => {
  if (user) {
    currentUid = user.uid;
    await loadTeachersForSameGrade();
  }
});

function showToast(txt, t = 3000) {
  toast.textContent = txt;
  toast.style.display = 'block';
  setTimeout(() => (toast.style.display = 'none'), t);
}
</script>

  </body>        
</html>